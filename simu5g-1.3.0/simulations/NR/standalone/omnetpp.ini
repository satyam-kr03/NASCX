[General]
# If you want to run this scenario, make sure abstract is false (set true only for templates)
abstract = false
sim-time-limit = 20s
**.routingRecorder.enabled = false

############### Statistics ##################
output-scalar-file = ${resultdir}/${configname}/${repetition}.sca
output-vector-file = ${resultdir}/${configname}/${repetition}.vec
seed-set = ${repetition}
**.vector-recording = true
# ensure scalar recording isn't disabled elsewhere

################ Mobility parameters ####################
**.mobility.constraintAreaMaxX = 1000m
**.mobility.constraintAreaMaxY = 1000m
**.mobility.constraintAreaMinX = 0m
**.mobility.constraintAreaMinY = 0m
**.mobility.constraintAreaMinZ = 0m
**.mobility.constraintAreaMaxZ = 0m
**.mobility.initFromDisplayString = false

############### Number of Resource Blocks ###############
# TODO: verify correct parameter name in Simu5G (numPRB / numResourceBlocks / numBands)
**.numPRB = 273     # 273 PRBs ~= 100 MHz @ 30 kHz SCS (confirm exact name)

############### Transmission Power ##################
**.ueTxPower = 26dBm
**.eNodeBTxPower = 40dBm
**.targetBler = 0.01
**.blerShift = 5

############### Channel Model ##################
# TODO: confirm exact model class & parameter names in Simu5G
# Example: enable a Rayleigh / flat fading channel if supported by your channelModel
**.channelModel.type = "Rayleigh"        # verify parameter name
**.channelModel.fading = "fast"          # verify parameter name / enum

############### IPv4 configurator config #################
*.configurator.config = xmldoc("./demo.xml")

#------------------------------------#
# Config Standalone
[Config Standalone]
network = simu5g.simulations.NR.networks.SingleCell_Standalone
sim-time-limit = 20s

############### gNodeB configuration #################
*.gnb.mobility.initialX = 450m
*.gnb.mobility.initialY = 300m

############## UE configuration ##################
*.numUe = 5

# --- Loop to auto-configure multiple UEs ---
*.ue[*].macCellId = 0
*.ue[*].masterId = 0
*.ue[*].nrMacCellId = 1
*.ue[*].nrMasterId = 1

# UE initial positions
*.ue[0].mobility.initialX = 450m
*.ue[0].mobility.initialY = 350m
*.ue[1].mobility.initialX = 400m
*.ue[1].mobility.initialY = 350m
*.ue[2].mobility.initialX = 500m
*.ue[2].mobility.initialY = 350m
*.ue[3].mobility.initialX = 450m
*.ue[3].mobility.initialY = 400m
*.ue[4].mobility.initialX = 450m
*.ue[4].mobility.initialY = 250m

#------------------------------------#
# Config XRTraffic-UL
[Config XRTraffic-UL]
extends = Standalone

# Applications
*.ue[*].numApps = 1
*.server.numApps = 5    # one sink app per UE

#============= Application Setup =============
# UE sends traffic
*.ue[*].app[0].typename = "simu5g.apps.XRTraffic.TrafficSource"
# If the app expects a rate string, use '30Mbps' â€” otherwise use integer in bps
*.ue[*].app[0].fps = 60
*.ue[*].app[0].data_rate = 30   # or: 30000000  -> VERIFY what the app expects
*.ue[*].app[0].destAddress = "server"
*.ue[*].app[0].destPort = 3000 + parent.index
*.ue[*].app[0].localPort = 3088 + parent.index

# Server receives traffic (XRTrafficSink)
*.server.app[*].typename = "simu5g.apps.XRTraffic.XRTrafficSink"
*.server.app[*].localPort = 3000 + index
*.server.app[*].packetsPerFrame = 1
*.server.app[*].deadline = 16ms
*.server.app[*].rmsePerFrame = 0.05  # Initial value, actual MSE should come from packets